# Docker æ¬Šé™å•é¡Œå¿«é€Ÿä¿®æ­£

## ğŸ” å•é¡Œèªªæ˜

å¦‚æœæ‚¨çœ‹åˆ°ã€ŒâŒ Docker æœªé‹è¡Œã€ä½†ç¶²é æ˜æ˜æ­£å¸¸é‹ä½œï¼Œé€™é€šå¸¸æ˜¯**æ¬Šé™å•é¡Œ**ã€‚

---

## âœ… æˆ‘å·²ç¶“ä¿®æ­£äº†è…³æœ¬

æ–°ç‰ˆæœ¬çš„ `deploy-updates.sh` ç¾åœ¨æœƒï¼š

1. âœ… è‡ªå‹•æª¢æ¸¬æ˜¯å¦éœ€è¦ä½¿ç”¨ `sudo`
2. âœ… å¦‚æœæœå‹™æ­£åœ¨é‹è¡Œï¼Œæœƒè©¢å•æ˜¯å¦ç¹¼çºŒ
3. âœ… æ™ºèƒ½é¸æ“‡æ­£ç¢ºçš„å‘½ä»¤åŸ·è¡Œæ–¹å¼

---

## ğŸš€ ç¾åœ¨å¯ä»¥ç›´æ¥åŸ·è¡Œ

```bash
./deploy-updates.sh
```

è…³æœ¬æœƒè‡ªå‹•è™•ç†æ¬Šé™å•é¡Œï¼

---

## ğŸ’¡ ä¸‰ç¨®è§£æ±ºæ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼šä½¿ç”¨ sudoï¼ˆæœ€ç°¡å–®ï¼‰

```bash
sudo ./deploy-updates.sh
```

### æ–¹æ¡ˆ Bï¼šå°‡ç”¨æˆ¶åŠ å…¥ docker ç¾¤çµ„ï¼ˆæ¨è–¦ï¼Œä¸€å‹æ°¸é€¸ï¼‰

```bash
# å°‡ç•¶å‰ç”¨æˆ¶åŠ å…¥ docker ç¾¤çµ„
sudo usermod -aG docker $USER

# é‡æ–°ç™»å…¥æˆ–åŸ·è¡Œ
newgrp docker

# é©—è­‰
docker ps
```

### æ–¹æ¡ˆ Cï¼šæ‰‹å‹•éƒ¨ç½²ï¼ˆå¦‚æœè…³æœ¬é‚„æ˜¯æœ‰å•é¡Œï¼‰

```bash
# åœæ­¢æœå‹™
sudo docker-compose stop frontend backend cms

# é‡æ–°æ§‹å»º
sudo docker-compose build frontend backend cms

# å•Ÿå‹•æœå‹™
sudo docker-compose up -d

# æª¢æŸ¥ç‹€æ…‹
sudo docker-compose ps
```

---

## ğŸ” ç¢ºèªå•é¡Œé¡å‹

### æ¸¬è©¦ 1ï¼šæª¢æŸ¥ Docker æ˜¯å¦éœ€è¦ sudo

```bash
# ä¸ä½¿ç”¨ sudo
docker ps

# å¦‚æœå‡ºéŒ¯ï¼Œè©¦è©¦ sudo
sudo docker ps
```

**å¦‚æœ `sudo docker ps` å¯ä»¥é‹è¡Œ**ï¼Œè¡¨ç¤ºæ˜¯æ¬Šé™å•é¡Œã€‚

### æ¸¬è©¦ 2ï¼šæª¢æŸ¥æœå‹™æ˜¯å¦é‹è¡Œ

```bash
# æª¢æŸ¥ Frontend
curl http://localhost:3000

# æª¢æŸ¥ Backend
curl http://localhost:8000/docs

# æª¢æŸ¥ CMS
curl http://localhost:1337/admin
```

**å¦‚æœé€™äº›éƒ½å¯ä»¥è¨ªå•**ï¼Œè¡¨ç¤ºæœå‹™æ­£å¸¸é‹è¡Œã€‚

---

## ğŸ“‹ ä½¿ç”¨æ–°è…³æœ¬çš„æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šåŸ·è¡Œè…³æœ¬

```bash
./deploy-updates.sh
```

### æ­¥é©Ÿ 2ï¼šå¦‚æœæç¤ºéœ€è¦ sudo

è…³æœ¬æœƒé¡¯ç¤ºï¼š
```
âš ï¸  éœ€è¦ä½¿ç”¨ sudo åŸ·è¡Œ Docker å‘½ä»¤
â„¹ï¸  å»ºè­°å°‡ç•¶å‰ç”¨æˆ¶åŠ å…¥ docker ç¾¤çµ„
```

ç„¶å¾Œè‡ªå‹•ä½¿ç”¨ `sudo` ç¹¼çºŒåŸ·è¡Œã€‚

### æ­¥é©Ÿ 3ï¼šå¦‚æœæª¢æ¸¬åˆ°æœå‹™æ­£åœ¨é‹è¡Œ

è…³æœ¬æœƒé¡¯ç¤ºï¼š
```
âš ï¸  Docker å‘½ä»¤ç„¡æ³•åŸ·è¡Œï¼Œä½†æœå‹™æ­£åœ¨é‹è¡Œ
â„¹ï¸  é€™å¯èƒ½æ˜¯æ¬Šé™å•é¡Œæˆ–ä½¿ç”¨å…¶ä»–æ–¹å¼éƒ¨ç½²
æ˜¯å¦ç¹¼çºŒéƒ¨ç½²ï¼Ÿ(y/n)
```

è¼¸å…¥ `y` ç¹¼çºŒå³å¯ã€‚

---

## ğŸ¯ æ¨è–¦æ–¹æ¡ˆï¼šæ°¸ä¹…è§£æ±ºæ¬Šé™å•é¡Œ

### åœ¨ GCP ä¸ŠåŸ·è¡Œï¼š

```bash
# 1. å°‡ç”¨æˆ¶åŠ å…¥ docker ç¾¤çµ„
sudo usermod -aG docker $USER

# 2. é‡æ–°è¼‰å…¥ç¾¤çµ„è¨­å®š
newgrp docker

# 3. é©—è­‰ï¼ˆæ‡‰è©²ä¸éœ€è¦ sudoï¼‰
docker ps

# 4. åŸ·è¡Œéƒ¨ç½²
./deploy-updates.sh
```

é€™æ¨£ä»¥å¾Œå°±ä¸éœ€è¦æ¯æ¬¡éƒ½ä½¿ç”¨ `sudo` äº†ï¼

---

## ğŸ”§ å¸¸è¦‹å•é¡Œ

### Q1: ç‚ºä»€éº¼æœƒæœ‰æ¬Šé™å•é¡Œï¼Ÿ

**A:** Docker daemon é è¨­éœ€è¦ root æ¬Šé™ã€‚å¦‚æœç”¨æˆ¶ä¸åœ¨ `docker` ç¾¤çµ„ä¸­ï¼Œå°±éœ€è¦ä½¿ç”¨ `sudo`ã€‚

### Q2: åŠ å…¥ docker ç¾¤çµ„å®‰å…¨å—ï¼Ÿ

**A:** åœ¨é–‹ç™¼å’Œéƒ¨ç½²ç’°å¢ƒä¸­æ˜¯å¸¸è¦‹åšæ³•ã€‚ä½†è«‹æ³¨æ„ï¼Œdocker ç¾¤çµ„çš„ç”¨æˆ¶å¯¦éš›ä¸Šæœ‰é¡ä¼¼ root çš„æ¬Šé™ã€‚

### Q3: æˆ‘çš„æœå‹™æ˜¯ç”¨å…¶ä»–æ–¹å¼å•Ÿå‹•çš„ï¼Ÿ

**A:** æ²’å•é¡Œï¼æ–°è…³æœ¬æœƒæª¢æ¸¬æœå‹™æ˜¯å¦é‹è¡Œï¼Œä¸¦è©¢å•æ‚¨æ˜¯å¦ç¹¼çºŒã€‚

### Q4: è…³æœ¬åŸ·è¡Œåˆ°ä¸€åŠå¤±æ•—äº†ï¼Ÿ

**A:** æª¢æŸ¥å‚™ä»½ï¼š
```bash
ls -la backups/
```

æŸ¥çœ‹æœ€è¿‘çš„å‚™ä»½ï¼Œå¿…è¦æ™‚å¯ä»¥æ‰‹å‹•æ¢å¾©ã€‚

---

## ğŸ†˜ å¦‚æœé‚„æ˜¯æœ‰å•é¡Œ

### æ”¶é›†è¨ºæ–·è³‡è¨Š

```bash
# 1. æª¢æŸ¥ Docker ç‰ˆæœ¬
docker --version
sudo docker --version

# 2. æª¢æŸ¥ Docker æœå‹™ç‹€æ…‹
sudo systemctl status docker
# æˆ–
sudo service docker status

# 3. æª¢æŸ¥ç•¶å‰ç”¨æˆ¶ç¾¤çµ„
groups

# 4. æª¢æŸ¥å®¹å™¨ç‹€æ…‹
sudo docker ps -a

# 5. æª¢æŸ¥ docker-compose ç‰ˆæœ¬
docker-compose --version
sudo docker-compose --version
```

### æ‰‹å‹•é©—è­‰éƒ¨ç½²

```bash
# é€²å…¥å°ˆæ¡ˆç›®éŒ„
cd /Users/rogershen/Documents/GitHub/npp-traffic165-2025

# ä½¿ç”¨ sudo åŸ·è¡Œæ‰€æœ‰å‘½ä»¤
sudo docker-compose stop frontend backend cms
sudo docker-compose build frontend backend cms
sudo docker-compose up -d
sudo docker-compose ps
```

---

## âœ¨ ç¸½çµ

### æœ€ç°¡å–®çš„æ–¹æ³•

```bash
# æ–¹æ³• 1ï¼šç›´æ¥åŸ·è¡Œï¼ˆè…³æœ¬æœƒè‡ªå‹•è™•ç†ï¼‰
./deploy-updates.sh

# æ–¹æ³• 2ï¼šä½¿ç”¨ sudo
sudo ./deploy-updates.sh

# æ–¹æ³• 3ï¼šæ°¸ä¹…è§£æ±º
sudo usermod -aG docker $USER
newgrp docker
./deploy-updates.sh
```

### æ–°è…³æœ¬çš„æ”¹é€²

- âœ… è‡ªå‹•æª¢æ¸¬æ¬Šé™å•é¡Œ
- âœ… æ™ºèƒ½ä½¿ç”¨ sudo
- âœ… æª¢æ¸¬æœå‹™é‹è¡Œç‹€æ…‹
- âœ… æ›´å‹å–„çš„éŒ¯èª¤è¨Šæ¯
- âœ… æä¾›ç¹¼çºŒåŸ·è¡Œé¸é …

---

**ç¾åœ¨å¯ä»¥å®‰å¿ƒåŸ·è¡Œéƒ¨ç½²äº†ï¼** ğŸš€

