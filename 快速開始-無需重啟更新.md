# 🚀 快速開始：無需重啟即可更新

## ✅ 我已經幫您完成的工作

### 1. 縮短緩存時間
- ✅ Frontend 緩存：從 300 秒改為 **60 秒**
- ✅ Backend 緩存：從 300 秒改為 **60 秒**

**這意味著：即使不設定 Webhook，您的修改最多 60 秒後就會自動更新！**

---

## 📋 您需要做的事（兩種方案）

### 方案 A：完整方案（推薦） - 3-5 秒即時更新

#### 步驟 1：執行自動設定腳本

```bash
cd /Users/rogershen/Documents/GitHub/npp-traffic165-2025
./setup-auto-revalidate.sh
```

這個腳本會：
1. 自動生成安全密鑰
2. 提供 Webhook 設定資訊
3. 重啟必要的服務

#### 步驟 2：在 Strapi 中設定 Webhooks

腳本會提供完整的 Webhook 設定資訊，您只需要：

1. 訪問：http://34.81.244.21:1337/admin
2. 進入：**Settings** > **Webhooks**
3. 點擊：**Add new webhook**
4. 複製貼上腳本提供的資訊
5. 儲存並測試

#### 完成！

從現在開始，您在 CMS 中的修改會在 **3-5 秒內**自動反映到前台！

---

### 方案 B：簡化方案 - 60 秒自動更新

如果您覺得設定 Webhook 太複雜，可以只使用已經修改好的緩存時間。

#### 步驟：重啟服務（只需要這一次）

```bash
docker-compose up -d --build frontend backend
```

#### 完成！

從現在開始，您在 CMS 中的修改最多 **60 秒後**就會自動更新，無需再次重啟！

---

## 💡 使用方式

### 修改內容

1. 登入 CMS：http://34.81.244.21:1337/admin
2. 修改任何內容：
   - Homepage Settings（首頁標題等）
   - KPI Configuration（KPI 配置）
   - Dashboard Settings（儀表板設定）
3. 點擊 **Save**

### 查看更新

#### 如果使用方案 A（Webhook）：
- 等待 3-5 秒
- 重新整理前台（F5）
- ✅ 看到更新！

#### 如果使用方案 B（緩存）：
- 等待最多 60 秒
- 重新整理前台（F5）
- ✅ 看到更新！

---

## 🎯 實際測試

### 測試步驟

1. **修改首頁標題**
   ```
   CMS > Content Manager > Homepage Setting > Single Entry
   修改 Page Title
   點擊 Save
   ```

2. **等待**
   - 方案 A：等待 3-5 秒
   - 方案 B：等待 60 秒

3. **驗證**
   ```
   訪問：http://34.81.244.21:3000
   按 F5 重新整理
   看到新標題！🎉
   ```

---

## 📊 方案比較

| 項目 | 方案 A（Webhook） | 方案 B（緩存） |
|------|------------------|---------------|
| 更新速度 | 3-5 秒 ⚡ | 60 秒 ✅ |
| 需重啟 | ❌ 不需要 | ❌ 不需要 |
| 設定難度 | ⭐⭐⭐ 中等 | ⭐ 簡單 |
| 一次性設定 | 15 分鐘 | 5 分鐘 |
| 可靠性 | 極高 | 高 |

---

## ⚠️ 重要提醒

### 第一次部署時需要重啟

因為我修改了緩存時間，您需要重啟一次服務來套用變更：

```bash
docker-compose up -d --build frontend backend
```

**這是最後一次需要手動重啟！**

之後所有 CMS 的修改都會自動更新，無需再重啟。

---

## 🔧 疑難排解

### 問題：修改後沒有更新

**檢查清單：**

1. ✓ 是否已經重啟服務（第一次部署後）？
2. ✓ 是否已經等待足夠時間？
   - Webhook：3-5 秒
   - 緩存：60 秒
3. ✓ 瀏覽器是否強制重新整理？
   - Windows/Linux：Ctrl + Shift + R
   - Mac：Cmd + Shift + R

### 問題：想知道當前狀態

```bash
# 檢查服務狀態
docker-compose ps

# 檢查 Frontend 日誌
docker-compose logs -f frontend

# 測試 API
curl http://34.81.244.21:8000/api/cms/homepage-settings
```

---

## 📚 更多資訊

詳細的技術說明和進階設定請參考：

- **[自動更新設定指南.md](./自動更新設定指南.md)** - 完整的技術文件
- **[完整解決方案總結.md](./完整解決方案總結.md)** - 所有問題的解決方案

---

## ✨ 總結

### 現況

✅ **緩存時間已縮短為 60 秒**  
✅ **無需再手動重啟服務**  
✅ **修改後最多等待 60 秒即可自動更新**  

### 建議

🎯 **如果您經常更新內容**  
→ 建議花 15 分鐘設定 Webhook（方案 A）  
→ 可以做到 3-5 秒即時更新

🎯 **如果偶爾更新**  
→ 使用現有的 60 秒緩存即可（方案 B）  
→ 已經足夠快速

---

## 🚀 立即開始

### 選擇方案 A（推薦）

```bash
./setup-auto-revalidate.sh
```

### 選擇方案 B

```bash
docker-compose up -d --build frontend backend
```

**就這麼簡單！從現在開始，您再也不需要重啟系統了！** 🎉

---

**有任何問題嗎？**  
請參考 `自動更新設定指南.md` 或執行 `./setup-auto-revalidate.sh`

